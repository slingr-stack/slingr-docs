---
title: "Listeners"
description: "Explains what listeners are and how they can be used to work with events of the app."
date: 2020-11-16T13:59:39+01:00
lastmod: 2020-11-16T13:59:39+01:00
draft: false
images: []
menu:
  docs:
    parent: "dev-reference"
toc: true
weight: 25
---

Listeners allow you to connect with various events within the app. For instance, you can listen to the creation of records or the reception of an event from an legacy service and take certain actions when these events occur.

Apart from event listening, it's also possible to schedule listeners to run periodically based on a CRON expression.

## **Label**

This represents the human-readable name of the listener.

## **Name**

This serves as the internal name of the listener.

The name cannot include special characters or spaces, only letters and numbers are allowed.

## **Type**

The listener type indicates the category of events it will be observing. The available types include:

- **`Data`**: Data listeners can tap into data-related events such as record creation, record updates, or the execution of actions on records. When selecting this type, additional settings can be configured to filter the specific data events to be handled:
  - **`Entity`**: The listener will focus on events within records under this entity.
  - **`Events`**: Specifies which data events the listener will process. Refer to the [Data events]({{<ref "/dev-reference/metadata-management/metadata-common/data-events.md">}}) for more details.
- **`Legacy service`**: Legacy service listeners can intercept events sent from legacy services. For example, an HTTP legacy service can generate an event when a webhook is triggered, which can then be processed by a listener. When choosing this type, further settings can be customized to filter the events to be managed:
  - **`Legacy services`**: The listener will be attuned to events generated by this specific legacy service.
  - **`Event`**: Indicates the specific event to be considered.
- **`UI plugin`**: These listeners can capture events and callbacks originating from UI plugins. When opting for this type, you can specify additional settings to filter the events to be handled:
  - **`Plugin`**: The plugin to which the listener will be attuned.
  - **`Event`**: The event/callback emanating from the plugin.
- **`Job`**: Job listeners can respond to user events like job start or job completion. When selecting this type, additional settings can be defined to filter the job events to be handled:
  - **`Job`**: The category of job that the listener will be observing.
  - **`Event`**: Specifies the particular event to be considered.
- **`Time`**: Time listeners execute based on a CRON expression. When selecting this type, additional settings can be configured:
  - **`Timezone`**: The timezone employed for the CRON expression.
  - **`Expression`**: The expression determining when the listener will execute. For more information on the expression format, please review this [documentation](http://www.quartz-scheduler.org/documentation/quartz-2.3.0/tutorials/tutorial-lesson-06.html).

## **Execute in the background**

For certain event types (such as **`Data`**), you can decide whether the listener should execute synchronously or be sent to the background.

For instance, if this flag isn't enabled and the listener pertains to a record creation, the operation won't conclude until the listener's execution is finished. Therefore, you should enable this flag when the listener's execution might surpass an acceptable time frame for the ongoing operation.

## **Avoid Triggering UI events**

Enabling this flag ensures that when the listener is triggered in the background, it bypasses sending notifications to the UI. This feature proves valuable in avoiding additional overhead during execution. A typical use case is executing a listener for batch processing, where notifying end users about data changes isn't necessary.

## **Action**

This refers to the script that will be executed when the event is triggered. Depending on the event type, the script's context will differ.

### Data listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "DATA",&#13;  "dataEvent": "RECORD_CHANGED&#13;}</code></pre><br> - Possible values for **`dataEvent`** are: **`RECORD_CREATED`**, **`RECORD_CHANGED`**, **`RECORD_DELETED`**, **`CONDITION_MET`**, **`ACTION_PERFORMED`**. |
| **`record`**   | [sys.data.Record]({{<ref "/dev-reference/scripting/sys-data.md#sysdatarecord">}})   | The record involved in the data operation.<br> There is one case where this variable will be empty, which when the event.dataEvent is **`ACTION_PERFORMED`** and the action executed was of type Many records. In this case, as the action is executed over a group of records, it isnâ€™t possible to set a single record.|
| **`oldRecord`**| [sys.data.Record]({{<ref "/dev-reference/scripting/sys-data.md#sysdatarecord">}})   | If the event is of type **`RECORD_CHANGED`**, **`ACTION_PERFORMED`**, or **`CONDITION_MET`**, this variable will hold the version of the record before the event occurred. |

##### Samples

``` js
// logs a message when there is a data event (the listener is configured accordingly)
sys.logs.info('*** EVENT: '+event.dataEvent);
sys.logs.info('*** RECORD: '+record.label());
```
<br>

### Legacy services listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "ENDPOINT",&#13;  "date": 1486673333420,&#13;  "endpoint": "sample",&#13;  "endpointEvent": "inboundEvent",&#13;  "data": {&#13;    "token": "123456",&#13;    "number": 4468&#13;  }&#13;}</code></pre><br><br> **`date`** is the timestamp when the event was sent.<br> **`endpoint`** is the name of the endpoint.<br>**`endpointEvent`** is the name of the event.<br> **`data`** is data sent by the endpoint which is specific for each event and you should check the documentation for each endpoint.

##### Samples

``` js
// logs the data sent by the endpoint
sys.logs.info('*** ENDPOINT: '+event.endpoint);
sys.logs.info('*** EVENT: '+event.endpointEvent);
sys.logs.info('*** DATA: '+event.data);
```
<br>

### Service listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "SERVICE",&#13;  "date": 1486673333420,&#13;  "endpoint": "sample",&#13;  "endpointEvent": "inboundEvent",&#13;  "data": {&#13;    "token": "123456",&#13;    "number": 4468&#13;  }&#13;}</code></pre><br><br> **`date`** is the timestamp when the event was sent.<br> **`service`** is the name of the service.<br>**`serviceEvent`** is the name of the event.<br> **`data`** is data sent by the endpoint which is specific for each event and you should check the documentation for each service.

##### Samples

``` js
// logs the data sent by the package
sys.logs.info('*** SERVICE: '+event.service);
sys.logs.info('*** EVENT: '+event.serviceEvent);
sys.logs.info('*** DATA: '+event.data);
```
<br>

### UI service listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "UI_SERVICE",&#13;  "date": 1486673333420,&#13;  "uiService": "sample",&#13;  "event": "event1",&#13;  "callback": "callback1",&#13;  "data": {&#13;    "originalMessage": {&#13;      "companyId": "ABC"&#13;    },&#13;    "callbackData": {&#13;      "number": 1234,&#13;      "text": "hello"&#13;    }&#13;  }&#13;}</code></pre><br><br> **`date`** is the timestamp when the event was sent.<br> **`uiService`** is the name of the uiService.<br>**`event`** is the name of the event.<br>**`callback`** is the name of the callback.<br> **`data`** is data sent by the callback request.

##### Samples

``` js
// logs the data sent by the ui service
sys.logs.info('*** UI_SERVICE: '+event.uiService);
sys.logs.info('*** DATA: '+event.data);
```
<br>

### UI plugin listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "PLUGIN",&#13;  "date": 1486673333420,&#13;  "plugin": "sample",&#13;  "event": "event1",&#13;  "callback": "callback1",&#13;  "data": {&#13;    "originalMessage": {&#13;      "companyId": "ABC"&#13;    },&#13;    "callbackData": {&#13;      "number": 1234,&#13;      "text": "hello"&#13;    }&#13;  }&#13;}</code></pre><br><br> **`date`** is the timestamp when the event was sent.<br> **`plugin`** is the name of the plugin.<br>**`event`** is the name of the event.<br>**`callback`** is the name of the callback.<br> **`data`** is data sent by the callback request.

##### Samples

``` js
// logs the data sent by the plugin
sys.logs.info('*** PLUGIN: '+event.plugin);
sys.logs.info('*** DATA: '+event.data);
```
<br>

### Job listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "JOB",&#13;  "jobType": "IMPORT_RECORDS",&#13;  "jobEvent": "FINISHED",&#13;  "jobId": "589cdb2ae201af1d75ec2d83"&#13;}</code></pre><br><br> **`jobType`** is the type of job<br> **`jobEvent`** is the event of the job that triggered the listener.<br>**`jobId`**  is the ID of the job. You can use it to find the job and get more information about it.

##### Samples

``` js
// finds job and checks if it had errors
var job = sys.jobs.findById(event.jobId);
sys.logs.info('*** ERRORS: '+job.hasErrors());
```
<br>

### Time listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "TIME"&#13;}</code></pre>

##### Samples

``` js
// logs something when the timer is triggered
sys.logs.info('*** TIME LISTENER!');
```
<br>

### Custom event listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "CUSTOM",&#13;  "customEvent": "newNote",&#13;  "customData": {&#13;    "noteId": "589cdb2ae201af1d75ec2d83"&#13;  }&#13;}</code></pre><br><br> **`customEvent`** is the name of custom event that triggered the listener.<br> **`customData`** is an object sent by user as data opf this custom event.

##### Samples

``` js
// log note ID create
sys.logs.info('*** NOTE CREATED: '+customData.noteId);
```
<br>

### Package event listeners

##### Parameters

| Name         | Type              | Description |
|--------------|-------------------|-----------|
| **`event`**    | object            | Contains information about the event. It has the following structure: <br><pre><code>{&#13;  "type": "CUSTOM",&#13;  "packageEvent": "newNote",&#13;  "package": "newNote", &#13;  "data": {&#13;    "messageContent": "589cdb2ae201af1d75ec2d83"&#13;  }&#13;}</code></pre><br><br> **`packageEvent`** is the name of the package event that triggered the listener.<br> **`data`** is an object sent by user as data of this package event. <br> **`package`**  is the name of the package.

##### Samples

``` js
// log message content
sys.logs.info('*** NEW MESSAGE CREATED: '+data.messageContent);
```
<br>
